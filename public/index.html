<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>115 Task Master Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #3b82f6; --bg: #f3f4f6; --card: #fff; --text: #1f2937; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); margin: 0; height: 100vh; display: flex; flex-direction: column; }
        
        /* Auth Screen */
        #authScreen { position: fixed; inset: 0; background: #fff; z-index: 100; display: flex; align-items: center; justify-content: center; }
        .auth-box { width: 320px; padding: 40px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; }
        .auth-box h2 { margin-top: 0; color: var(--primary); }
        
        /* Main App */
        .app-container { max-width: 800px; margin: 40px auto; width: 90%; flex: 1; display: none; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .card { background: var(--card); padding: 24px; border-radius: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 20px; }
        
        /* Forms */
        input, select, button { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #e5e7eb; border-radius: 6px; box-sizing: border-box; }
        button { background: var(--primary); color: white; border: none; cursor: pointer; font-weight: 600; transition: opacity 0.2s; }
        button:hover { opacity: 0.9; }
        .btn-outline { background: transparent; color: var(--text); border: 1px solid #e5e7eb; }
        .btn-danger { background: #ef4444; color: white; border: none; }
        .btn-edit { background: #3b82f6; color: white; border: none; }
        .btn-run { background: #10b981; color: white; border: none; } /* æ–°å¢è¿è¡ŒæŒ‰é’®æ ·å¼ */
        
        /* Task List */
        .task-item { background: #f9fafb; padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #ccc; }
        .task-item.running { border-left-color: #3b82f6; }
        .task-item.success { border-left-color: #10b981; }
        .task-item.error { border-left-color: #ef4444; }
        .task-item.scheduled { border-left-color: #8b5cf6; } /* å®šæ—¶ä»»åŠ¡é¢œè‰² */

        .task-header { display: flex; justify-content: space-between; align-items: flex-start; }
        .task-link { font-size: 1.05rem; font-weight: 600; color: var(--primary); text-decoration: none; display: inline-block; margin-bottom: 4px; }
        .task-link:hover { text-decoration: underline; }
        .task-meta { font-size: 0.85rem; color: #6b7280; display: flex; gap: 10px; margin-bottom: 6px; }
        .task-log { font-size: 0.8rem; color: #4b5563; background: #e5e7eb; padding: 4px 8px; border-radius: 4px; display: inline-block; margin-top: 4px;}

        /* Cron Builder */
        .cron-builder { display: flex; gap: 8px; align-items: center; justify-content: space-between; }
        .cron-field { flex: 1; text-align: center; }
        .cron-field label { font-size: 0.7rem; color: #666; display: block; margin-bottom: 4px; font-weight: 500; }
        .cron-field input { text-align: center; padding: 8px 2px; font-family: monospace; margin-bottom: 0; }
        .cron-preview { font-family: monospace; background: #1f2937; color: #10b981; padding: 10px; border-radius: 6px; margin-top: 10px; font-size: 0.85rem; }

        /* Modal */
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 200; }
        .modal-content { background: white; padding: 20px; border-radius: 12px; width: 450px; max-height: 80vh; display: flex; flex-direction: column; overflow-y: auto; }
        
        .row { display: flex; gap: 10px; }
    </style>
</head>
<body>

    <div id="authScreen">
        <div class="auth-box">
            <h2>115 Task Master</h2>
            <input type="text" id="username" placeholder="ç”¨æˆ·å">
            <input type="password" id="password" placeholder="å¯†ç ">
            <button onclick="doLogin()">ç™»å½•</button>
            <button onclick="doRegister()" class="btn-outline" style="margin-top: 10px;">æ³¨å†Œæ–°è´¦å·</button>
        </div>
    </div>

    <div class="app-container" id="app">
        <div class="header">
            <h3>ğŸ‘‹ ä½ å¥½, <span id="currentUser">ç”¨æˆ·</span></h3>
            <button onclick="logout()" class="btn-outline" style="width: auto; padding: 6px 12px; font-size: 0.85rem;">ğŸšª é€€å‡ºç™»å½•</button>
        </div>

        <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <strong>ğŸ“‚ 115 è´¦å·çŠ¶æ€</strong>
                <span id="accountStatus" style="font-size:0.9rem; color:gray">æœªè¿æ¥</span>
            </div>
            <div style="margin-top: 15px; display: flex; gap: 10px;">
                <input type="text" id="cookieInput" placeholder="è¾“å…¥ Cookie (UID/CID/SEID...)" style="margin:0;">
                <button onclick="saveConfig()" style="width: 100px; margin:0;">ä¿å­˜</button>
            </div>
        </div>

        <div class="card">
            <h3>â• æ–°å»ºæ™ºèƒ½ä»»åŠ¡</h3>
            <div style="font-size:0.85rem; color:#666; margin-bottom:12px; background:#f3f4f6; padding:8px; border-radius:6px;">
                ğŸ’¡ <b>è‡ªåŠ¨å‘½å</b>ï¼šç•™ç©ºä»»åŠ¡åç§°ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è·å–åˆ†äº«æ ‡é¢˜ä½œä¸ºä»»åŠ¡åï¼Œ**ä¸ä¼šè‡ªåŠ¨æ–°å»ºæ–‡ä»¶å¤¹**ã€‚
            </div>
            
            <div class="row">
                <input type="text" id="taskName" placeholder="ä»»åŠ¡åç§° (ç•™ç©ºåˆ™è‡ªåŠ¨å‘½å)">
            </div>
            
            <input type="text" id="shareUrl" placeholder="åˆ†äº«é“¾æ¥ (https://115.com/s/...)">
            
            <div class="row">
                <input type="text" id="accessCode" placeholder="æå–ç  (å¯é€‰)">
                <div style="display:flex; gap:5px; width: 100%;">
                    <input type="text" id="targetPath" value="æ ¹ç›®å½•" readonly style="background:#eee;">
                    <input type="hidden" id="targetCid" value="0">
                    <button onclick="openFolderPicker(false)" class="btn-outline" style="width:70px;">é€‰æ‹©ç›®å½•</button>
                </div>
            </div>

            <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #bae6fd;">
                <label style="font-size:0.9rem; font-weight:700; color:#0369a1; display:flex; justify-content:space-between;">
                    <span>â±ï¸ å®šæ—¶è®¡åˆ’ (Cron)</span>
                    <span style="font-weight:400; font-size:0.8rem; color:#0284c7; cursor:pointer;" onclick="clearCron('create')">[ é‡ç½®/ä»…ä¸€æ¬¡ ]</span>
                </label>
                <div style="margin-top: 10px;">
                    <div class="cron-builder">
                        <div class="cron-field"><label>åˆ†</label><input type="text" id="cron_m" placeholder="*" oninput="updateCronPreview('create')"></div>
                        <div class="cron-field"><label>æ—¶</label><input type="text" id="cron_h" placeholder="*" oninput="updateCronPreview('create')"></div>
                        <div class="cron-field"><label>æ—¥</label><input type="text" id="cron_dom" placeholder="*" oninput="updateCronPreview('create')"></div>
                        <div class="cron-field"><label>æœˆ</label><input type="text" id="cron_mon" placeholder="*" oninput="updateCronPreview('create')"></div>
                        <div class="cron-field"><label>å‘¨</label><input type="text" id="cron_dow" placeholder="*" oninput="updateCronPreview('create')"></div>
                    </div>
                    <div class="cron-preview" id="cronResult">æ‰§è¡Œç­–ç•¥: ä»…ä¸€æ¬¡ (ç«‹å³æ‰§è¡Œ)</div>
                </div>
            </div>

            <button onclick="createTask()">ğŸš€ å¼€å§‹ä»»åŠ¡</button>
        </div>

        <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <h3 style="margin:0;">ğŸ“‹ ä»»åŠ¡é˜Ÿåˆ—</h3>
                <button onclick="loadTasks()" class="btn-outline" style="width:auto; padding:5px 12px;">åˆ·æ–°</button>
            </div>
            <div id="taskList"></div>
        </div>
    </div>

    <div id="editModal" class="modal">
        <div class="modal-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <strong>âœï¸ ç¼–è¾‘ä»»åŠ¡</strong>
                <span onclick="document.getElementById('editModal').style.display='none'" style="cursor:pointer; font-size:1.5rem;">&times;</span>
            </div>
            
            <input type="hidden" id="editTaskId">
            
            <label style="font-size:0.8rem; color:#666;">ä»»åŠ¡åç§°</label>
            <input type="text" id="editTaskName" placeholder="ä»»åŠ¡åç§°">
            
            <label style="font-size:0.8rem; color:#666;">åˆ†äº«é“¾æ¥</label>
            <input type="text" id="editShareUrl" placeholder="åˆ†äº«é“¾æ¥">
            
            <label style="font-size:0.8rem; color:#666;">æå–ç </label>
            <input type="text" id="editAccessCode" placeholder="æå–ç  (å¯é€‰)">
            
            <label style="font-size:0.8rem; color:#666;">ä¿å­˜ä½ç½®</label>
            <div class="row" style="margin-bottom:10px;">
                <div style="display:flex; gap:5px; width: 100%;">
                    <input type="text" id="editTargetPath" readonly style="background:#eee; margin-bottom:0;">
                    <input type="hidden" id="editTargetCid">
                    <button onclick="openFolderPicker(true)" class="btn-outline" style="width:70px; margin-bottom:0;">ä¿®æ”¹</button>
                </div>
            </div>

            <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #bae6fd;">
                <label style="font-size:0.9rem; font-weight:700; color:#0369a1; display:flex; justify-content:space-between;">
                    <span>â±ï¸ å®šæ—¶è®¡åˆ’ (Cron)</span>
                    <span style="font-weight:400; font-size:0.8rem; color:#0284c7; cursor:pointer;" onclick="clearCron('edit')">[ é‡ç½® ]</span>
                </label>
                <div style="margin-top: 10px;">
                    <div class="cron-builder">
                        <div class="cron-field"><label>åˆ†</label><input type="text" id="edit_cron_m" placeholder="*" oninput="updateCronPreview('edit')"></div>
                        <div class="cron-field"><label>æ—¶</label><input type="text" id="edit_cron_h" placeholder="*" oninput="updateCronPreview('edit')"></div>
                        <div class="cron-field"><label>æ—¥</label><input type="text" id="edit_cron_dom" placeholder="*" oninput="updateCronPreview('edit')"></div>
                        <div class="cron-field"><label>æœˆ</label><input type="text" id="edit_cron_mon" placeholder="*" oninput="updateCronPreview('edit')"></div>
                        <div class="cron-field"><label>å‘¨</label><input type="text" id="edit_cron_dow" placeholder="*" oninput="updateCronPreview('edit')"></div>
                    </div>
                    <div class="cron-preview" id="editCronResult">æ‰§è¡Œç­–ç•¥: æœªå˜æ›´</div>
                </div>
            </div>

            <button onclick="updateTask()">ä¿å­˜ä¿®æ”¹</button>
        </div>
    </div>

    <div id="folderModal" class="modal">
        <div class="modal-content">
            <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                <strong>é€‰æ‹©ä¿å­˜ä½ç½®</strong>
                <span onclick="document.getElementById('folderModal').style.display='none'" style="cursor:pointer; font-size:1.5rem;">&times;</span>
            </div>
            <div id="folderBreadcrumb" style="font-size:0.85rem; color:#2563eb; margin-bottom:10px; font-weight:500;">/</div>
            <div id="folderList" style="flex:1; overflow-y:auto; border:1px solid #e5e7eb; border-radius:6px; margin-bottom:10px;"></div>
            <button onclick="confirmFolder()">ç¡®è®¤é€‰æ‹©å½“å‰ç›®å½•</button>
        </div>
    </div>

<script>
    let token = localStorage.getItem('token');
    let curCid = "0", curPathName = "æ ¹ç›®å½•";
    let isEditMode = false; // æ ‡è®°å½“å‰æ–‡ä»¶å¤¹é€‰æ‹©å™¨æ˜¯ä¸ºç¼–è¾‘æœåŠ¡çš„
    let allTasks = [];      // ç¼“å­˜ä»»åŠ¡åˆ—è¡¨ç”¨äºç¼–è¾‘å›æ˜¾

    if(token) showApp();

    // --- æ ¸å¿ƒ ---
    function logout() { localStorage.clear(); location.reload(); }

    function showApp() {
        document.getElementById('currentUser').innerText = localStorage.getItem('username') || 'ç”¨æˆ·';
        document.getElementById('authScreen').style.display = 'none';
        document.getElementById('app').style.display = 'block';
        loadConfig();
        loadTasks();
        setInterval(loadTasks, 5000);
    }

    async function request(endpoint, method='GET', body=null) {
        const headers = { 'Content-Type': 'application/json' };
        if(token) headers['Authorization'] = `Bearer ${token}`;
        try {
            const res = await fetch(`/api${endpoint}`, { method, headers, body: body ? JSON.stringify(body) : null });
            if(res.status === 401) { logout(); return { success: false, msg: "ç™»å½•å¤±æ•ˆ" }; }
            return await res.json();
        } catch(e) { console.error(e); return { success: false, msg: "ç½‘ç»œé”™è¯¯" }; }
    }

    async function doLogin() {
        const u = document.getElementById('username').value;
        const p = document.getElementById('password').value;
        const res = await request('/login', 'POST', { username: u, password: p });
        if(res.success) {
            token = res.token; localStorage.setItem('token', token);
            localStorage.setItem('username', res.username);
            showApp();
        } else alert(res.msg);
    }
    async function doRegister() {
        const u = document.getElementById('username').value;
        const p = document.getElementById('password').value;
        const res = await request('/register', 'POST', { username: u, password: p });
        if(res.success) alert("æ³¨å†ŒæˆåŠŸï¼Œè¯·ç™»å½•"); else alert(res.msg);
    }

    async function loadConfig() {
        const res = await request('/config');
        if(res.name) {
            document.getElementById('accountStatus').innerText = `âœ… å·²è¿æ¥: ${res.name}`;
            document.getElementById('accountStatus').style.color = '#10b981';
            document.getElementById('cookieInput').placeholder = "Cookie å·²ä¿å­˜";
        }
    }
    async function saveConfig() {
        const cookie = document.getElementById('cookieInput').value;
        if(!cookie) return alert("æ— å†…å®¹");
        const res = await request('/config', 'POST', { cookie });
        if(res.success) { alert("è¿æ¥æˆåŠŸ"); loadConfig(); } else alert(res.msg);
    }

    // --- Cron å·¥å…· ---
    function getCronParts(prefix) {
        return ['_m', '_h', '_dom', '_mon', '_dow'].map(s => document.getElementById(prefix + s).value.trim());
    }
    
    function updateCronPreview(mode) {
        const prefix = mode === 'edit' ? 'edit_cron' : 'cron';
        const resultId = mode === 'edit' ? 'editCronResult' : 'cronResult';
        
        const vals = getCronParts(prefix);
        const hasValue = vals.some(v => v !== "");
        
        if (!hasValue) {
            document.getElementById(resultId).innerText = "æ‰§è¡Œç­–ç•¥: " + (mode === 'edit' ? "æ—  (åœæ­¢å®šæ—¶)" : "ä»…ä¸€æ¬¡ (ç«‹å³æ‰§è¡Œ)");
            document.getElementById(resultId).style.color = "#6b7280";
            return "";
        }
        
        const finalParts = vals.map(v => v === "" ? "*" : v);
        const cronStr = finalParts.join(" ");
        let desc = `Cron: ${cronStr}`;
        if(cronStr === "* * * * *") desc = "âš ï¸ æ¯åˆ†é’Ÿæ‰§è¡Œ (ä¸æ¨è)";
        
        document.getElementById(resultId).innerText = desc;
        document.getElementById(resultId).style.color = "#10b981";
        return cronStr;
    }

    function clearCron(mode) {
        const prefix = mode === 'edit' ? 'edit_cron' : 'cron';
        ['_m', '_h', '_dom', '_mon', '_dow'].forEach(s => document.getElementById(prefix + s).value = '');
        updateCronPreview(mode);
    }

    // --- ä»»åŠ¡æ“ä½œ ---

    async function createTask() {
        const cronExpression = updateCronPreview('create');
        const payload = {
            taskName: document.getElementById('taskName').value,
            shareUrl: document.getElementById('shareUrl').value,
            password: document.getElementById('accessCode').value,
            targetCid: document.getElementById('targetCid').value,
            targetName: document.getElementById('targetPath').value,
            cronExpression: cronExpression
        };
        if(!payload.shareUrl) return alert("åˆ†äº«é“¾æ¥ä¸èƒ½ä¸ºç©º");
        const res = await request('/task', 'POST', payload);
        if(res.success) {
            document.getElementById('taskName').value = '';
            document.getElementById('shareUrl').value = '';
            alert('âœ… ä»»åŠ¡åˆ›å»ºæˆåŠŸï¼Œå·²å¼€å§‹é¦–æ¬¡æ‰§è¡Œ'); loadTasks();
        } else alert("âŒ å¤±è´¥: " + res.msg);
    }
    
    // ã€æ–°å¢ã€‘æ‰‹åŠ¨æ‰§è¡Œä»»åŠ¡å‡½æ•°
    async function runTaskNow(id) {
        const task = allTasks.find(t => t.id === id);
        if(!task) return alert('ä»»åŠ¡ä¸å­˜åœ¨');
        if(task.status === 'running') return alert('ä»»åŠ¡æ­£åœ¨è¿è¡Œä¸­ï¼Œè¯·ç¨å€™');
        
        if(confirm(`ç¡®å®šç«‹å³æ‰§è¡Œä»»åŠ¡: ${task.taskName}?`)) {
            // æ–°å¢ä¸€ä¸ª PUT æ¥å£æ¥è§¦å‘ processTask
            const res = await request(`/task/${id}/run`, 'PUT');
            if(res.success) {
                alert('âœ… ä»»åŠ¡å·²å¯åŠ¨ï¼Œè¯·ç­‰å¾…çŠ¶æ€åˆ·æ–°');
                loadTasks();
            } else {
                alert("âŒ å¯åŠ¨å¤±è´¥: " + res.msg);
            }
        }
    }

    async function loadTasks() {
        const tasks = await request('/tasks');
        allTasks = tasks; // ç¼“å­˜
        const html = tasks.map(t => `
            <div class="task-item ${t.status}">
                <div class="task-header">
                    <div>
                        <a href="${t.shareUrl || '#'}" target="_blank" class="task-link" title="ä¸Šæ¬¡æˆåŠŸ: ${t.lastSuccessDate || 'æ— '}">${t.taskName || 'æœªå‘½å'} ğŸ”—</a>
                        <div class="task-meta">
                            <span>ğŸ“‚ ${t.targetName}</span>
                            <span>|</span>
                            <span>â±ï¸ ${t.cronExpression ? t.cronExpression : 'æ‰‹åŠ¨'}</span>
                        </div>
                    </div>
                    <div style="display:flex; gap:5px;">
                        ${t.status !== 'running' ? `<button onclick="runTaskNow(${t.id})" class="btn-run" style="width:auto; padding:4px 10px; font-size:0.8rem;">æ‰§è¡Œ</button>` : ''}
                        <button onclick="openEditModal(${t.id})" class="btn-edit" style="width:auto; padding:4px 10px; font-size:0.8rem;">ç¼–è¾‘</button>
                        <button onclick="deleteTask(${t.id})" class="btn-danger" style="width:auto; padding:4px 10px; font-size:0.8rem;">åˆ é™¤</button>
                    </div>
                </div>
                <div class="task-log">${t.status === 'scheduled' ? 'â³' : (t.status==='success'?'âœ…':'â–¶ï¸')} ${t.log || 'ç­‰å¾…ä¸­...'}</div>
            </div>
        `).join('');
        document.getElementById('taskList').innerHTML = html || '<div style="text-align:center; color:#999;">æš‚æ— ä»»åŠ¡</div>';
    }

    async function deleteTask(id) {
        if(confirm('ç¡®å®šåˆ é™¤?')) { await request(`/task/${id}`, 'DELETE'); loadTasks(); }
    }

    // --- ç¼–è¾‘åŠŸèƒ½ ---

    function openEditModal(id) {
        const task = allTasks.find(t => t.id === id);
        if(!task) return;

        document.getElementById('editTaskId').value = id;
        document.getElementById('editTaskName').value = task.taskName || '';
        document.getElementById('editShareUrl').value = task.shareUrl || '';
        document.getElementById('editAccessCode').value = task.receiveCode || '';
        document.getElementById('editTargetCid').value = task.targetCid || '0';
        document.getElementById('editTargetPath').value = task.targetName || 'æ ¹ç›®å½•';

        // è¿˜åŸ Cron
        if (task.cronExpression) {
            const parts = task.cronExpression.split(' ');
            if (parts.length === 5) {
                ['m','h','dom','mon','dow'].forEach((k, i) => {
                    document.getElementById(`edit_cron_${k}`).value = parts[i] === '*' ? '' : parts[i];
                });
            }
        } else {
            clearCron('edit');
        }
        updateCronPreview('edit');
        
        document.getElementById('editModal').style.display = 'flex';
    }

    async function updateTask() {
        const id = document.getElementById('editTaskId').value;
        const cronExp = updateCronPreview('edit');
        
        const payload = {
            taskName: document.getElementById('editTaskName').value,
            shareUrl: document.getElementById('editShareUrl').value,
            password: document.getElementById('editAccessCode').value,
            targetCid: document.getElementById('editTargetCid').value,
            targetName: document.getElementById('editTargetPath').value,
            cronExpression: cronExp
        };

        const res = await request(`/task/${id}`, 'PUT', payload);
        if(res.success) {
            document.getElementById('editModal').style.display = 'none';
            alert('âœ… ä»»åŠ¡æ›´æ–°æˆåŠŸ');
            loadTasks();
        } else {
            alert("æ›´æ–°å¤±è´¥: " + res.msg);
        }
    }

    // --- ç›®å½•é€‰æ‹© ---

    async function openFolderPicker(editMode) {
        isEditMode = editMode;
        document.getElementById('folderModal').style.display = 'flex';
        // ç¡®ä¿ä»æ ¹ç›®å½•å¼€å§‹åŠ è½½ï¼Œé˜²æ­¢å®šä½é”™ä¹±
        loadFolders("0"); 
    }

    async function loadFolders(cid) {
        const listDiv = document.getElementById('folderList');
        listDiv.innerHTML = '<div style="padding:10px;">åŠ è½½ä¸­...</div>';
        const res = await request(`/folders?cid=${cid}`);
        if(res.success) {
            curCid = cid;
            const paths = res.data.path || [];
            curPathName = paths.length ? paths.map(p=>p.name).join(' > ') : 'æ ¹ç›®å½•';
            document.getElementById('folderBreadcrumb').innerText = curPathName;
            
            let html = cid !== '0' ? `<div style="padding:10px; cursor:pointer; background:#f9fafb;" onclick="loadFolders('${paths.length>1 ? paths[paths.length-2].cid : '0'}')">â¬…ï¸ è¿”å›ä¸Šä¸€çº§</div>` : '';
            res.data.list.forEach(f => {
                html += `<div style="padding:10px; border-bottom:1px solid #eee; cursor:pointer;" onclick="loadFolders('${f.cid}')">ğŸ“ ${f.name}</div>`;
            });
            listDiv.innerHTML = html || '<div style="padding:10px;">ç©ºæ–‡ä»¶å¤¹</div>';
        } else {
            listDiv.innerHTML = '<div style="padding:10px; color:red;">åŠ è½½å¤±è´¥</div>';
        }
    }

    function confirmFolder() {
        if (isEditMode) {
            document.getElementById('editTargetPath').value = curPathName;
            document.getElementById('editTargetCid').value = curCid;
        } else {
            document.getElementById('targetPath').value = curPathName;
            document.getElementById('targetCid').value = curCid;
        }
        document.getElementById('folderModal').style.display = 'none';
    }
</script>
</body>
</html>
